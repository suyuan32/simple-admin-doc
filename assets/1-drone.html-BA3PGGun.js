import{_ as a}from"./plugin-vue_export-helper-DlAUqK2U.js";import{r as n,c as e,d as i,e as t,b as l,o as h}from"./app-DkUatYOC.js";const k={},p=i("h2",{id:"drone-ci-files-generating",tabindex:"-1"},[i("a",{class:"header-anchor",href:"#drone-ci-files-generating"},[i("span",null,"Drone CI Files Generating")])],-1),r={class:"hint-container info"},d=i("p",{class:"hint-container-title"},"Video tutorial",-1),o=l(`<h2 id="create-drone-ci-file" tabindex="-1"><a class="header-anchor" href="#create-drone-ci-file"><span>Create Drone CI file</span></a></h2><blockquote><p>Create .drone.yaml and Dockerfile files</p></blockquote><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" data-title="shell" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">goctls</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> cicd</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> drone</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -d=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;core&quot;</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -g=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;gitee.com&quot;</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -s=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;core&quot;</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -x=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;rpc&quot;</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -b=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;master&quot;</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -r=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;registry.cn-beijing.aliyuncs.com&quot;</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -o=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;registry.cn-hangzhou.aliyuncs.com/simple_admin/core-api-docker:v1.1.0&quot;</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -e=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;core&quot;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><div class="hint-container warning"><p class="hint-container-title">Warning</p><p>repo parameter For latest: -o=&quot;registry.cn-hangzhou.aliyuncs.com/simple_admin/core-api-docker&quot; For non-latest: -o=&quot;registry.cn-hangzhou.aliyuncs.com/simple_admin/core-api-docker:v1.1.0&quot;</p></div><h3 id="introduction-to-cicd-drone-parameters" tabindex="-1"><a class="header-anchor" href="#introduction-to-cicd-drone-parameters"><span>Introduction to <code>cicd drone</code> parameters</span></a></h3><table><thead><tr><th>Parameter</th><th>Required</th><th>Default Value</th><th>Description</th><th>Usage</th></tr></thead><tbody><tr><td>drone_name</td><td>No</td><td>drone-greet</td><td>Drone name</td><td>Customize a name for drone</td></tr><tr><td>go_private</td><td>Yes</td><td>gitee.com</td><td>Go private repository settings</td><td>For example: gitee.com | github.com</td></tr><tr><td>service_name</td><td>Yes</td><td>None</td><td>Go-zero service main program entry file</td><td>For example: core.go, the suffix .go must be omitted</td></tr><tr><td>service_type</td><td>No</td><td>happy</td><td>Go-zero service type</td><td>For example: rpc | api</td></tr><tr><td>git_branch</td><td>No</td><td>main</td><td>Git repository branch</td><td>Depending on your own git branch</td></tr><tr><td>registry</td><td>Yes</td><td>None</td><td>Remote image repository address</td><td>For example, Alibaba Cloud mirror address: registry.cn-beijing.aliyuncs.com</td></tr><tr><td>repo</td><td>Yes</td><td>None</td><td>Remote image repository address</td><td>If the tag is not &#39;latest&#39;, it needs to be specified, for example: git-repo:v0.0.1, if it is &#39;latest&#39;, it needs to be ignored</td></tr><tr><td>etc_yaml</td><td>Yes</td><td>None</td><td>Dockerfile configuration used by drone in the CI process</td><td>The yaml configuration file name under the etc folder of the go-zero project</td></tr></tbody></table><p><strong>For detailed parameters, use <code>goctls cicd drone -h</code> in the command line</strong></p><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" data-title="shell" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">$</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> goctls</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> cicd</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> drone</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -h</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">Generate</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> Drone</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> yaml</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> and</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> Dockerfile</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">Usage:</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">  goctls</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> cicd</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> drone</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> [flags]</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">Flags:</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">  -d,</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> --drone_name</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> string</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">     The</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> Drone</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> name</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">  -e,</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> --etc_yaml</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> string</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">       The</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> Dockerfile</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> with</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> drone</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> used,</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> go-zero</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> project</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> etc</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> yaml</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> file</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> name</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> (required)</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">  -b,</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> --git_branch</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> string</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">     The</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> branch</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> of</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> the</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> remote</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> repo,</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> default</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &quot;main&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">  (default </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;master&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">  -g,</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> --go_private</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> string</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">     Go</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> private</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> such</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> as:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> gitee.com</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">|</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">github.com,</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> default</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &quot;gitee.com&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> (required) (</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">default</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &quot;gitee.com&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">  -h,</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> --help</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">                  help</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> for</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> drone</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">  -r,</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> --registry</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> string</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">       The</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> remote</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> Docker</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> Registry,</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> if</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> aliyun</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> ACR</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> such</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> as:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> registry.cn-beijing.aliyuncs.com</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> (required)</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">  -o,</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> --repo</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> string</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">           The</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> remote</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> Git</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> Repository,</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> if</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> tag</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> is</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> not</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &#39;latest&#39;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> please</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> assign</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> tag</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> such</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> as:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> git-repo:v0.0.1,</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> if</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> tag</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> is</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> latest</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> you</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> can</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> ignore</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> the</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> tag</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> (required)</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">  -s,</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> --service_name</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> string</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">   The</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> service</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> name</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> of</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> the</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> main</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> project</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> go</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> file,</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> such</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> as:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> core.go,</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> you</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> must</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> ignore</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> suffix:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> .go</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">  (required)</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">  -x,</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> --service_type</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> string</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">   The</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> service</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> type</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> such</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> as:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> rpc</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">|</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">api,</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> default</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &quot;happy&quot;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><blockquote><p>You can see the following structure <br> Note: The .drone.yml file generated in the Mac environment is hidden by default and requires the command <code>Command + Shift + .</code> to be visible.</p></blockquote><img width="298" alt="image" src="https://github.com/suyuan32/simple-admin-doc/assets/5540291/ff0ee451-bccd-4783-a92c-2a59f1a834a7"><h3 id="file-structure" tabindex="-1"><a class="header-anchor" href="#file-structure"><span>File Structure</span></a></h3><div class="language-text line-numbers-mode" data-highlighter="shiki" data-ext="text" data-title="text" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span>├── example                           go-zero project</span></span>
<span class="line"><span>├── .drone.yml                        configuration file directory</span></span>
<span class="line"><span>└── Dockerfile                        Dockerfile configuration file</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><blockquote><p>.drone.yml <br> docker_username and docker_password in the yml file are the account and password of the repository configured in drone for pulling private images.</p></blockquote><div class="language-yaml line-numbers-mode" data-highlighter="shiki" data-ext="yaml" data-title="yaml" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">kind</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">pipeline</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">type</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">docker</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">name</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">core-rpc</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">steps</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">:</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">  - </span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">name</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">build-go</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">    image</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">golang:1.20.3</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">    depends_on</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: [</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">clone</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">]</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">    volumes</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">:</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">      - </span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">name</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">go_cache</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">        path</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">/go/pkg/mod</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">    commands</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">:</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">      - </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">go env -w CGO_ENABLED=0</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">      - </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">go env -w GOPROXY=https://goproxy.cn,direct</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">      - </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">go env -w GOPRIVATE=gitee.com</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">      - </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">go mod tidy &amp;&amp; go build -trimpath -ldflags &quot;-s -w&quot; -o app core.go</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">  - </span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">name</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">build-rpc</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">    image</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">plugins/docker:20</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">    environment</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">:</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">      DRONE_REPO_BRANCH</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">master</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">    depends_on</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: [</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">build-go</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">]</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">    settings</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">:</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">      dockerfile</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">Dockerfile</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">      registry</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">registry.cn-beijing.aliyuncs.com</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">      repo</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">registry.cn-hangzhou.aliyuncs.com/simple_admin/core-api-docker:v1.1.0</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">      auto_tag</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">true</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">      insecure</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">true</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">      username</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">:</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">        from_secret</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">docker_username</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">      password</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">:</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">        from_secret</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">docker_password</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">trigger</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">:</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">  ref</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">:</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    - </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">refs/tags/*</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    - </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">refs/heads/master</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">volumes</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">:</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">  - </span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">name</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">go_cache</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">    host</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">:</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">      path</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">/root/.go/cache</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><blockquote><p>Dockerfile</p></blockquote><div class="language-plain line-numbers-mode" data-highlighter="shiki" data-ext="plain" data-title="plain" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span>FROM alpine</span></span>
<span class="line"><span></span></span>
<span class="line"><span>RUN apk update &amp;&amp; apk add tzdata</span></span>
<span class="line"><span>RUN ln -sf /usr/share/zoneinfo/Asia/Shanghai /etc/localtime</span></span>
<span class="line"><span></span></span>
<span class="line"><span>COPY ./app /app/</span></span>
<span class="line"><span>COPY ./etc/core.yaml /app/etc/core.yaml</span></span>
<span class="line"><span>workdir /app/</span></span>
<span class="line"><span>ENTRYPOINT [&quot;./app&quot;]</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,16);function c(g,y){const s=n("BiliBili");return h(),e("div",null,[p,i("div",r,[d,t(s,{bvid:"BV1ZN411b7sp"})]),o])}const m=a(k,[["render",c],["__file","1-drone.html.vue"]]),u=JSON.parse('{"path":"/guide/cicd/1-drone.html","title":"Drone CI","lang":"en-US","frontmatter":{"order":1,"title":"Drone CI","head":[["meta",{"name":"keywords","content":"drone ci, ci/cd, simple admin ci/cd, continuous"}],["link",{"rel":"alternate","hreflang":"zh-cn","href":"https://doc.ryansu.tech/zh/guide/cicd/1-drone.html"}],["meta",{"property":"og:url","content":"https://doc.ryansu.tech/guide/cicd/1-drone.html"}],["meta",{"property":"og:site_name","content":"Simple Admin"}],["meta",{"property":"og:title","content":"Drone CI"}],["meta",{"property":"og:description","content":"Drone CI Files Generating Video tutorial Create Drone CI file Create .drone.yaml and Dockerfile files Warning repo parameter For latest: -o=\\"registry.cn-hangzhou.aliyuncs.com/si..."}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:locale","content":"en-US"}],["meta",{"property":"og:locale:alternate","content":"zh-CN"}],["meta",{"property":"og:updated_time","content":"2024-05-28T10:47:03.000Z"}],["meta",{"property":"article:author","content":"Ryan SU"}],["meta",{"property":"article:modified_time","content":"2024-05-28T10:47:03.000Z"}],["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"Drone CI\\",\\"image\\":[\\"\\"],\\"dateModified\\":\\"2024-05-28T10:47:03.000Z\\",\\"author\\":[{\\"@type\\":\\"Person\\",\\"name\\":\\"Ryan SU\\",\\"url\\":\\"https://github.com/suyuan32\\"}]}"]],"description":"Drone CI Files Generating Video tutorial Create Drone CI file Create .drone.yaml and Dockerfile files Warning repo parameter For latest: -o=\\"registry.cn-hangzhou.aliyuncs.com/si..."},"headers":[{"level":2,"title":"Drone CI Files Generating","slug":"drone-ci-files-generating","link":"#drone-ci-files-generating","children":[]},{"level":2,"title":"Create Drone CI file","slug":"create-drone-ci-file","link":"#create-drone-ci-file","children":[{"level":3,"title":"Introduction to cicd drone parameters","slug":"introduction-to-cicd-drone-parameters","link":"#introduction-to-cicd-drone-parameters","children":[]},{"level":3,"title":"File Structure","slug":"file-structure","link":"#file-structure","children":[]}]}],"git":{"createdTime":1691031420000,"updatedTime":1716893223000,"contributors":[{"name":"Ryan SU","email":"yuansu.china.work@gmail.com","commits":3},{"name":"Ryan Su","email":"yuansu.china.work@gmail.com","commits":3}]},"readingTime":{"minutes":1.98,"words":593},"filePathRelative":"guide/cicd/1-drone.md","localizedDate":"August 3, 2023","autoDesc":true,"excerpt":"<h2>Drone CI Files Generating</h2>\\n<div class=\\"hint-container info\\">\\n<p class=\\"hint-container-title\\">Video tutorial</p>\\n</div>\\n<h2>Create Drone CI file</h2>\\n<blockquote>\\n<p>Create .drone.yaml and Dockerfile files</p>\\n</blockquote>\\n<div class=\\"language-shell line-numbers-mode\\" data-highlighter=\\"shiki\\" data-ext=\\"shell\\" data-title=\\"shell\\" style=\\"--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34\\"><pre class=\\"shiki shiki-themes one-light one-dark-pro vp-code\\"><code><span class=\\"line\\"><span style=\\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\\">goctls</span><span style=\\"--shiki-light:#50A14F;--shiki-dark:#98C379\\"> cicd</span><span style=\\"--shiki-light:#50A14F;--shiki-dark:#98C379\\"> drone</span><span style=\\"--shiki-light:#986801;--shiki-dark:#D19A66\\"> -d=</span><span style=\\"--shiki-light:#50A14F;--shiki-dark:#98C379\\">\\"core\\"</span><span style=\\"--shiki-light:#986801;--shiki-dark:#D19A66\\"> -g=</span><span style=\\"--shiki-light:#50A14F;--shiki-dark:#98C379\\">\\"gitee.com\\"</span><span style=\\"--shiki-light:#986801;--shiki-dark:#D19A66\\"> -s=</span><span style=\\"--shiki-light:#50A14F;--shiki-dark:#98C379\\">\\"core\\"</span><span style=\\"--shiki-light:#986801;--shiki-dark:#D19A66\\"> -x=</span><span style=\\"--shiki-light:#50A14F;--shiki-dark:#98C379\\">\\"rpc\\"</span><span style=\\"--shiki-light:#986801;--shiki-dark:#D19A66\\"> -b=</span><span style=\\"--shiki-light:#50A14F;--shiki-dark:#98C379\\">\\"master\\"</span><span style=\\"--shiki-light:#986801;--shiki-dark:#D19A66\\"> -r=</span><span style=\\"--shiki-light:#50A14F;--shiki-dark:#98C379\\">\\"registry.cn-beijing.aliyuncs.com\\"</span><span style=\\"--shiki-light:#986801;--shiki-dark:#D19A66\\"> -o=</span><span style=\\"--shiki-light:#50A14F;--shiki-dark:#98C379\\">\\"registry.cn-hangzhou.aliyuncs.com/simple_admin/core-api-docker:v1.1.0\\"</span><span style=\\"--shiki-light:#986801;--shiki-dark:#D19A66\\"> -e=</span><span style=\\"--shiki-light:#50A14F;--shiki-dark:#98C379\\">\\"core\\"</span></span></code></pre>\\n<div class=\\"line-numbers\\" aria-hidden=\\"true\\" style=\\"counter-reset:line-number 0\\"><div class=\\"line-number\\"></div></div></div>"}');export{m as comp,u as data};
