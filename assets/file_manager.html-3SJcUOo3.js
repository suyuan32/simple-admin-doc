import{_ as s}from"./plugin-vue_export-helper-DlAUqK2U.js";import{c as a,o as i,b as n}from"./app-B6C_gI66.js";const l={},e=n(`<h3 id="介绍" tabindex="-1"><a class="header-anchor" href="#介绍"><span>介绍</span></a></h3><p>Simple Admin 的文件上传管理服务. 支持本地上传， 支持任意 S3 协议云上传， 包括 阿里云， 腾讯云，七牛云， 天翼云, aws等。</p><h3 id="下载代码" tabindex="-1"><a class="header-anchor" href="#下载代码"><span>下载代码</span></a></h3><div class="language-shell line-numbers-mode" data-ext="shell" data-title="shell"><pre class="shiki shiki-themes github-light one-dark-pro vp-code" style="background-color:#fff;--shiki-dark-bg:#282c34;color:#24292e;--shiki-dark:#abb2bf;" tabindex="0"><code><span class="line"><span style="color:#6F42C1;--shiki-dark:#61AFEF;">git</span><span style="color:#032F62;--shiki-dark:#98C379;"> clone</span><span style="color:#032F62;--shiki-dark:#98C379;"> https://github.com/suyuan32/simple-admin-file.git</span></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h3 id="修改配置文件-etc-file-yaml" tabindex="-1"><a class="header-anchor" href="#修改配置文件-etc-file-yaml"><span>修改配置文件 etc/file.yaml</span></a></h3><h4 id="value" tabindex="-1"><a class="header-anchor" href="#value"><span>value</span></a></h4><div class="language-yaml line-numbers-mode" data-ext="yaml" data-title="yaml"><pre class="shiki shiki-themes github-light one-dark-pro vp-code" style="background-color:#fff;--shiki-dark-bg:#282c34;color:#24292e;--shiki-dark:#abb2bf;" tabindex="0"><code><span class="line"><span style="color:#22863A;--shiki-dark:#E06C75;">Name</span><span style="color:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="color:#032F62;--shiki-dark:#98C379;">file_manager_0</span></span>
<span class="line"><span style="color:#22863A;--shiki-dark:#E06C75;">Host</span><span style="color:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="color:#005CC5;--shiki-dark:#D19A66;">0.0.0.0</span></span>
<span class="line"><span style="color:#22863A;--shiki-dark:#E06C75;">Port</span><span style="color:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="color:#005CC5;--shiki-dark:#D19A66;">9102</span></span>
<span class="line"><span style="color:#22863A;--shiki-dark:#E06C75;">MaxBytes</span><span style="color:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="color:#005CC5;--shiki-dark:#D19A66;">1073741824</span><span style="color:#6A737D;--shiki-dark:#7F848E;font-style:inherit;--shiki-dark-font-style:italic;"> # 所有类型的最大容量 : 1 gb</span></span>
<span class="line"><span style="color:#22863A;--shiki-dark:#E06C75;">Timeout</span><span style="color:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="color:#005CC5;--shiki-dark:#D19A66;">30000</span><span style="color:#6A737D;--shiki-dark:#7F848E;font-style:inherit;--shiki-dark-font-style:italic;"> # 超时时间</span></span>
<span class="line"></span>
<span class="line"><span style="color:#22863A;--shiki-dark:#E06C75;">Auth</span><span style="color:#24292E;--shiki-dark:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#22863A;--shiki-dark:#E06C75;">  AccessSecret</span><span style="color:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="color:#032F62;--shiki-dark:#98C379;">jS6VKDtsJf3z1n2VKDtsJf3z1n2</span></span>
<span class="line"><span style="color:#22863A;--shiki-dark:#E06C75;">  AccessExpire</span><span style="color:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="color:#005CC5;--shiki-dark:#D19A66;">259200</span><span style="color:#6A737D;--shiki-dark:#7F848E;font-style:inherit;--shiki-dark-font-style:italic;"> # Seconds</span></span>
<span class="line"></span>
<span class="line"><span style="color:#22863A;--shiki-dark:#E06C75;">Log</span><span style="color:#24292E;--shiki-dark:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#22863A;--shiki-dark:#E06C75;">  ServiceName</span><span style="color:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="color:#032F62;--shiki-dark:#98C379;">fileManagerLogger</span></span>
<span class="line"><span style="color:#22863A;--shiki-dark:#E06C75;">  Mode</span><span style="color:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="color:#032F62;--shiki-dark:#98C379;">file</span></span>
<span class="line"><span style="color:#22863A;--shiki-dark:#E06C75;">  Path</span><span style="color:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="color:#032F62;--shiki-dark:#98C379;">/home/ryan/logs/file/api</span></span>
<span class="line"><span style="color:#22863A;--shiki-dark:#E06C75;">  Level</span><span style="color:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="color:#032F62;--shiki-dark:#98C379;">info</span></span>
<span class="line"><span style="color:#22863A;--shiki-dark:#E06C75;">  Compress</span><span style="color:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="color:#005CC5;--shiki-dark:#D19A66;">false</span></span>
<span class="line"><span style="color:#22863A;--shiki-dark:#E06C75;">  KeepDays</span><span style="color:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="color:#005CC5;--shiki-dark:#D19A66;">7</span></span>
<span class="line"><span style="color:#22863A;--shiki-dark:#E06C75;">  StackCoolDownMillis</span><span style="color:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="color:#005CC5;--shiki-dark:#D19A66;">100</span></span>
<span class="line"></span>
<span class="line"><span style="color:#22863A;--shiki-dark:#E06C75;">RedisConf</span><span style="color:#24292E;--shiki-dark:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#22863A;--shiki-dark:#E06C75;">  Host</span><span style="color:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="color:#032F62;--shiki-dark:#98C379;">127.0.0.1:6379</span></span>
<span class="line"><span style="color:#22863A;--shiki-dark:#E06C75;">  Type</span><span style="color:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="color:#032F62;--shiki-dark:#98C379;">node</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;--shiki-dark:#7F848E;font-style:inherit;--shiki-dark-font-style:italic;"># File Manager 服务的数据库</span></span>
<span class="line"><span style="color:#22863A;--shiki-dark:#E06C75;">DatabaseConf</span><span style="color:#24292E;--shiki-dark:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#22863A;--shiki-dark:#E06C75;">  Type</span><span style="color:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="color:#032F62;--shiki-dark:#98C379;">mysql</span></span>
<span class="line"><span style="color:#22863A;--shiki-dark:#E06C75;">  Host</span><span style="color:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="color:#005CC5;--shiki-dark:#D19A66;">127.0.0.1</span></span>
<span class="line"><span style="color:#22863A;--shiki-dark:#E06C75;">  Port</span><span style="color:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="color:#005CC5;--shiki-dark:#D19A66;">3306</span></span>
<span class="line"><span style="color:#22863A;--shiki-dark:#E06C75;">  DBName</span><span style="color:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="color:#032F62;--shiki-dark:#98C379;">simple_admin</span></span>
<span class="line"><span style="color:#22863A;--shiki-dark:#E06C75;">  Username</span><span style="color:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="color:#6A737D;--shiki-dark:#7F848E;font-style:inherit;--shiki-dark-font-style:italic;"># set your username</span></span>
<span class="line"><span style="color:#22863A;--shiki-dark:#E06C75;">  Password</span><span style="color:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="color:#6A737D;--shiki-dark:#7F848E;font-style:inherit;--shiki-dark-font-style:italic;"># set your password</span></span>
<span class="line"><span style="color:#22863A;--shiki-dark:#E06C75;">  MaxOpenConn</span><span style="color:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="color:#005CC5;--shiki-dark:#D19A66;">100</span></span>
<span class="line"><span style="color:#22863A;--shiki-dark:#E06C75;">  SSLMode</span><span style="color:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="color:#032F62;--shiki-dark:#98C379;">disable</span></span>
<span class="line"><span style="color:#22863A;--shiki-dark:#E06C75;">  CacheTime</span><span style="color:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="color:#005CC5;--shiki-dark:#D19A66;">5</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;--shiki-dark:#7F848E;font-style:inherit;--shiki-dark-font-style:italic;"># Casbin 数据库，需要 Core鉴权的话和 Core 保持一致</span></span>
<span class="line"><span style="color:#22863A;--shiki-dark:#E06C75;">CasbinDatabaseConf</span><span style="color:#24292E;--shiki-dark:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#22863A;--shiki-dark:#E06C75;">  Type</span><span style="color:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="color:#032F62;--shiki-dark:#98C379;">mysql</span></span>
<span class="line"><span style="color:#22863A;--shiki-dark:#E06C75;">  Host</span><span style="color:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="color:#005CC5;--shiki-dark:#D19A66;">127.0.0.1</span></span>
<span class="line"><span style="color:#22863A;--shiki-dark:#E06C75;">  Port</span><span style="color:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="color:#005CC5;--shiki-dark:#D19A66;">3306</span></span>
<span class="line"><span style="color:#22863A;--shiki-dark:#E06C75;">  DBName</span><span style="color:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="color:#032F62;--shiki-dark:#98C379;">simple_admin</span></span>
<span class="line"><span style="color:#22863A;--shiki-dark:#E06C75;">  Username</span><span style="color:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="color:#6A737D;--shiki-dark:#7F848E;font-style:inherit;--shiki-dark-font-style:italic;"># set your username</span></span>
<span class="line"><span style="color:#22863A;--shiki-dark:#E06C75;">  Password</span><span style="color:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="color:#6A737D;--shiki-dark:#7F848E;font-style:inherit;--shiki-dark-font-style:italic;"># set your password</span></span>
<span class="line"><span style="color:#22863A;--shiki-dark:#E06C75;">  MaxOpenConn</span><span style="color:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="color:#005CC5;--shiki-dark:#D19A66;">100</span></span>
<span class="line"><span style="color:#22863A;--shiki-dark:#E06C75;">  SSLMode</span><span style="color:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="color:#032F62;--shiki-dark:#98C379;">disable</span></span>
<span class="line"><span style="color:#22863A;--shiki-dark:#E06C75;">  CacheTime</span><span style="color:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="color:#005CC5;--shiki-dark:#D19A66;">5</span></span>
<span class="line"></span>
<span class="line"><span style="color:#22863A;--shiki-dark:#E06C75;">UploadConf</span><span style="color:#24292E;--shiki-dark:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#22863A;--shiki-dark:#E06C75;">  MaxImageSize</span><span style="color:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="color:#005CC5;--shiki-dark:#D19A66;">33554432</span><span style="color:#6A737D;--shiki-dark:#7F848E;font-style:inherit;--shiki-dark-font-style:italic;"> # 32 mb 最大图片大小</span></span>
<span class="line"><span style="color:#22863A;--shiki-dark:#E06C75;">  MaxVideoSize</span><span style="color:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="color:#005CC5;--shiki-dark:#D19A66;">1073741824</span><span style="color:#6A737D;--shiki-dark:#7F848E;font-style:inherit;--shiki-dark-font-style:italic;"> # 1gb 最大视频大小</span></span>
<span class="line"><span style="color:#22863A;--shiki-dark:#E06C75;">  MaxAudioSize</span><span style="color:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="color:#005CC5;--shiki-dark:#D19A66;">33554432</span><span style="color:#6A737D;--shiki-dark:#7F848E;font-style:inherit;--shiki-dark-font-style:italic;"> # 32mb 最大音频大小</span></span>
<span class="line"><span style="color:#22863A;--shiki-dark:#E06C75;">  MaxOtherSize</span><span style="color:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="color:#005CC5;--shiki-dark:#D19A66;">10485760</span><span style="color:#6A737D;--shiki-dark:#7F848E;font-style:inherit;--shiki-dark-font-style:italic;"> # 10 mb 最大其他类型大小</span></span>
<span class="line"><span style="color:#22863A;--shiki-dark:#E06C75;">  PrivateStorePath</span><span style="color:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="color:#032F62;--shiki-dark:#98C379;">/home/ryan/www/private</span><span style="color:#6A737D;--shiki-dark:#7F848E;font-style:inherit;--shiki-dark-font-style:italic;"> # private 私有文件路径</span></span>
<span class="line"><span style="color:#22863A;--shiki-dark:#E06C75;">  PublicStorePath</span><span style="color:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="color:#032F62;--shiki-dark:#98C379;">/home/ryan/www/public</span><span style="color:#6A737D;--shiki-dark:#7F848E;font-style:inherit;--shiki-dark-font-style:italic;"> # public path for every one access e.g. nginx path 公开文件路径</span></span>
<span class="line"><span style="color:#22863A;--shiki-dark:#E06C75;">  ServerURL</span><span style="color:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="color:#032F62;--shiki-dark:#98C379;">&quot;http://192.168.50.204:81&quot;</span><span style="color:#6A737D;--shiki-dark:#7F848E;font-style:inherit;--shiki-dark-font-style:italic;"> # 本地服务器地址</span></span>
<span class="line"><span style="color:#22863A;--shiki-dark:#E06C75;">  DeleteFileWithCloud</span><span style="color:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="color:#005CC5;--shiki-dark:#D19A66;">true</span><span style="color:#6A737D;--shiki-dark:#7F848E;font-style:inherit;--shiki-dark-font-style:italic;"> # 是否当删除本地数据库数据时删除云文件</span></span>
<span class="line"></span>
<span class="line"><span style="color:#22863A;--shiki-dark:#E06C75;">CoreRpc</span><span style="color:#24292E;--shiki-dark:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#22863A;--shiki-dark:#E06C75;">  Target</span><span style="color:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="color:#032F62;--shiki-dark:#98C379;">k8s://default/core-rpc-svc:9101</span><span style="color:#6A737D;--shiki-dark:#7F848E;font-style:inherit;--shiki-dark-font-style:italic;"> # core rpc address, use endpoint in local | core 服务RPC地址，本地测试使用直连</span></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="hint-container info"><p class="hint-container-title">相关信息</p><ul><li><p>你可以使用 nginx 将 PublicStorePath 转发为静态地址方便前端调用</p></li><li><p>确保 AccessSecret 和 simple-admin-core 的 api 配置文件内一致</p></li><li><p>配置方式参考 core</p></li><li><p>运行方式同理</p></li><li><p>初始化数据库 <a href="http://localhost:3100/init" target="_blank" rel="noopener noreferrer">http://localhost:3100/init</a></p></li><li><p>在角色页面添加 API 接口权限，然后重启 file 的 API，v1.0.14 之后无需重启</p></li></ul></div><h3 id="k8s-部署" tabindex="-1"><a class="header-anchor" href="#k8s-部署"><span>K8s 部署</span></a></h3><blockquote><p>和 core api 相似</p></blockquote><p>你应该做如下工作:</p><ul><li>通过 fileapi.yaml 部署服务</li><li>修改 simple-admin-backend-ui/deploy/default.conf ，解开 file-manager 注释</li><li>更新 ingress configmap</li><li>更新 ingress controller</li></ul>`,12),r=[e];function p(o,t){return i(),a("div",null,r)}const k=s(l,[["render",p],["__file","file_manager.html.vue"]]),h=JSON.parse('{"path":"/zh/guide/official-comp/file_manager.html","title":"文件上传模块","lang":"zh-CN","frontmatter":{"order":1,"title":"文件上传模块","head":[["meta",{"name":"keywords","content":"fms, upload, 文件上传, simple admin, s3, 配置"}],["link",{"rel":"alternate","hreflang":"en-us","href":"https://doc.ryansu.tech/guide/official-comp/file_manager.html"}],["meta",{"property":"og:url","content":"https://doc.ryansu.tech/zh/guide/official-comp/file_manager.html"}],["meta",{"property":"og:site_name","content":"Simple Admin"}],["meta",{"property":"og:title","content":"文件上传模块"}],["meta",{"property":"og:description","content":"介绍 Simple Admin 的文件上传管理服务. 支持本地上传， 支持任意 S3 协议云上传， 包括 阿里云， 腾讯云，七牛云， 天翼云, aws等。 下载代码 修改配置文件 etc/file.yaml value 相关信息 你可以使用 nginx 将 PublicStorePath 转发为静态地址方便前端调用 确保 AccessSecret 和 ..."}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:locale","content":"zh-CN"}],["meta",{"property":"og:locale:alternate","content":"en-US"}],["meta",{"property":"og:updated_time","content":"2024-05-20T10:41:28.000Z"}],["meta",{"property":"article:author","content":"Ryan SU"}],["meta",{"property":"article:modified_time","content":"2024-05-20T10:41:28.000Z"}],["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"文件上传模块\\",\\"image\\":[\\"\\"],\\"dateModified\\":\\"2024-05-20T10:41:28.000Z\\",\\"author\\":[{\\"@type\\":\\"Person\\",\\"name\\":\\"Ryan SU\\",\\"url\\":\\"https://github.com/suyuan32\\"}]}"]],"description":"介绍 Simple Admin 的文件上传管理服务. 支持本地上传， 支持任意 S3 协议云上传， 包括 阿里云， 腾讯云，七牛云， 天翼云, aws等。 下载代码 修改配置文件 etc/file.yaml value 相关信息 你可以使用 nginx 将 PublicStorePath 转发为静态地址方便前端调用 确保 AccessSecret 和 ..."},"headers":[{"level":3,"title":"介绍","slug":"介绍","link":"#介绍","children":[]},{"level":3,"title":"下载代码","slug":"下载代码","link":"#下载代码","children":[]},{"level":3,"title":"修改配置文件 etc/file.yaml","slug":"修改配置文件-etc-file-yaml","link":"#修改配置文件-etc-file-yaml","children":[]},{"level":3,"title":"K8s 部署","slug":"k8s-部署","link":"#k8s-部署","children":[]}],"git":{"createdTime":1671464359000,"updatedTime":1716201688000,"contributors":[{"name":"Ryan SU","email":"1137661202@qq.com","commits":7},{"name":"Ryan SU","email":"yuansu.china.work@gmail.com","commits":4},{"name":"Ryan Su","email":"yuansu.china.work@gmail.com","commits":1}]},"readingTime":{"minutes":1.56,"words":469},"filePathRelative":"zh/guide/official-comp/file_manager.md","localizedDate":"2022年12月19日","autoDesc":true,"excerpt":"<h3>介绍</h3>\\n<p>Simple Admin 的文件上传管理服务. 支持本地上传， 支持任意 S3 协议云上传， 包括 阿里云， 腾讯云，七牛云， 天翼云, aws等。</p>\\n<h3>下载代码</h3>\\n<div class=\\"language-shell line-numbers-mode\\" data-ext=\\"shell\\" data-title=\\"shell\\"><pre class=\\"shiki shiki-themes github-light one-dark-pro vp-code\\" style=\\"background-color:#fff;--shiki-dark-bg:#282c34;color:#24292e;--shiki-dark:#abb2bf\\" tabindex=\\"0\\"><code><span class=\\"line\\"><span style=\\"color:#6F42C1;--shiki-dark:#61AFEF\\">git</span><span style=\\"color:#032F62;--shiki-dark:#98C379\\"> clone</span><span style=\\"color:#032F62;--shiki-dark:#98C379\\"> https://github.com/suyuan32/simple-admin-file.git</span></span></code></pre>\\n<div class=\\"line-numbers\\" aria-hidden=\\"true\\"><div class=\\"line-number\\"></div></div></div>"}');export{k as comp,h as data};
