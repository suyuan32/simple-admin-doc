import{_ as t}from"./plugin-vue_export-helper-DlAUqK2U.js";import{r as l,o as c,c as o,a as e,f as n,b as a,e as i}from"./app-BRNPVzCm.js";const r={},p=e("h2",{id:"minikube-initialization",tabindex:"-1"},[e("a",{class:"header-anchor",href:"#minikube-initialization"},[e("span",null,"Minikube initialization")])],-1),d=e("h3",{id:"install",tabindex:"-1"},[e("a",{class:"header-anchor",href:"#install"},[e("span",null,"Install")])],-1),u={href:"https://minikube.sigs.k8s.io/docs/start/",target:"_blank",rel:"noopener noreferrer"},m=i(`<h3 id="start-minikube" tabindex="-1"><a class="header-anchor" href="#start-minikube"><span>Start minikube</span></a></h3><blockquote><p>Recommend to set the memory limit in local development，my setting is 3gb</p></blockquote><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code>minikube start <span class="token parameter variable">--memory</span> 3g
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h3 id="minikube-add-plugins" tabindex="-1"><a class="header-anchor" href="#minikube-add-plugins"><span>minikube add plugins</span></a></h3><blockquote><p>Enable ingress adn metrics (metrics is used in go-zero for auto-scaling monitor)</p></blockquote><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code>minikube addons <span class="token builtin class-name">enable</span> ingress
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h3 id="add-alias" tabindex="-1"><a class="header-anchor" href="#add-alias"><span>Add alias</span></a></h3><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code><span class="token builtin class-name">alias</span> <span class="token assign-left variable">kubectl</span><span class="token operator">=</span><span class="token string">&quot;minikube kubectl --&quot;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h3 id="deploy-the-service" tabindex="-1"><a class="header-anchor" href="#deploy-the-service"><span>Deploy the service</span></a></h3><blockquote><p>clone the code，cd deploy/k8s</p></blockquote><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code><span class="token comment"># add service discovery account</span>
kubectl apply <span class="token parameter variable">-f</span> auth.yaml

<span class="token comment"># create persistent volume for log</span>
kubectl apply <span class="token parameter variable">-f</span> pv.yaml

<span class="token comment"># modify core-rpc.yaml to set your own image</span>
kubectl apply <span class="token parameter variable">-f</span> core-rpc.yaml

<span class="token comment"># modify core-api.yaml to set your own image</span>
kubectl apply <span class="token parameter variable">-f</span> core-api.yaml

<span class="token comment"># modify backend-ui.yaml to set your own image</span>
kubectl apply <span class="token parameter variable">-f</span> backend-ui.yaml
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="hint-container info"><p class="hint-container-title">Info</p><p>You can just run simple-admin-core/deploy/k8s/setup.sh to finish the job.</p></div><h3 id="ingress-setting" tabindex="-1"><a class="header-anchor" href="#ingress-setting"><span>Ingress Setting</span></a></h3>`,13),k={href:"https://minikube.sigs.k8s.io/docs/tutorials/nginx_tcp_udp_ingress/",target:"_blank",rel:"noopener noreferrer"},b=i(`<h3 id="firstly-add-ingress" tabindex="-1"><a class="header-anchor" href="#firstly-add-ingress"><span>Firstly, add ingress</span></a></h3><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code>kubectl apply <span class="token parameter variable">-f</span> ingress.yaml
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><blockquote><p>Ingress.yaml file</p></blockquote><div class="language-yaml line-numbers-mode" data-ext="yml" data-title="yml"><pre class="language-yaml"><code><span class="token key atrule">apiVersion</span><span class="token punctuation">:</span> networking.k8s.io/v1
<span class="token key atrule">kind</span><span class="token punctuation">:</span> Ingress
<span class="token key atrule">metadata</span><span class="token punctuation">:</span>
  <span class="token key atrule">name</span><span class="token punctuation">:</span> simple<span class="token punctuation">-</span>admin<span class="token punctuation">-</span>ingress
  <span class="token key atrule">annotations</span><span class="token punctuation">:</span>
    <span class="token key atrule">nginx.ingress.kubernetes.io/rewrite-target</span><span class="token punctuation">:</span> /$1

<span class="token key atrule">spec</span><span class="token punctuation">:</span>
  <span class="token key atrule">rules</span><span class="token punctuation">:</span>
    <span class="token punctuation">-</span> <span class="token key atrule">host</span><span class="token punctuation">:</span> simple<span class="token punctuation">-</span>admin.com <span class="token comment"># your domain</span>
      <span class="token key atrule">http</span><span class="token punctuation">:</span>
        <span class="token key atrule">paths</span><span class="token punctuation">:</span>
          <span class="token punctuation">-</span> <span class="token key atrule">path</span><span class="token punctuation">:</span> /
            <span class="token key atrule">pathType</span><span class="token punctuation">:</span> Prefix
            <span class="token key atrule">backend</span><span class="token punctuation">:</span>
              <span class="token key atrule">service</span><span class="token punctuation">:</span>
                <span class="token key atrule">name</span><span class="token punctuation">:</span> backendui<span class="token punctuation">-</span>svc
                <span class="token key atrule">port</span><span class="token punctuation">:</span>
                  <span class="token key atrule">number</span><span class="token punctuation">:</span> <span class="token number">80</span>
    <span class="token punctuation">-</span> <span class="token key atrule">host</span><span class="token punctuation">:</span> simple<span class="token punctuation">-</span>admin.com <span class="token comment"># your domain</span>
      <span class="token key atrule">http</span><span class="token punctuation">:</span>
        <span class="token key atrule">paths</span><span class="token punctuation">:</span>
          <span class="token punctuation">-</span> <span class="token key atrule">path</span><span class="token punctuation">:</span> /sys<span class="token punctuation">-</span>api/
            <span class="token key atrule">pathType</span><span class="token punctuation">:</span> Prefix
            <span class="token key atrule">backend</span><span class="token punctuation">:</span>
              <span class="token key atrule">service</span><span class="token punctuation">:</span>
                <span class="token key atrule">name</span><span class="token punctuation">:</span> coreapi<span class="token punctuation">-</span>svc
                <span class="token key atrule">port</span><span class="token punctuation">:</span>
                  <span class="token key atrule">number</span><span class="token punctuation">:</span> <span class="token number">9100</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="register-tcp-service-into-ingress-configmap" tabindex="-1"><a class="header-anchor" href="#register-tcp-service-into-ingress-configmap"><span>Register tcp service into ingress configmap</span></a></h3><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code><span class="token comment"># register coreapi</span>
kubectl patch configmap tcp-services <span class="token parameter variable">-n</span> ingress-nginx <span class="token parameter variable">--patch</span> <span class="token string">&#39;{&quot;data&quot;:{&quot;9100&quot;:&quot;simple-admin/coreapi-svc:9100&quot;}}&#39;</span>
<span class="token comment"># register backendui, connect 8080 port to 80 in backendui service</span>
kubectl patch configmap tcp-services <span class="token parameter variable">-n</span> ingress-nginx <span class="token parameter variable">--patch</span> <span class="token string">&#39;{&quot;data&quot;:{&quot;8080&quot;:&quot;simple-admin/backendui-svc:80&quot;}}&#39;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="register-service-into-ingress-controller" tabindex="-1"><a class="header-anchor" href="#register-service-into-ingress-controller"><span>Register service into ingress controller</span></a></h3><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code>kubectl patch deployment ingress-nginx-controller <span class="token parameter variable">--patch</span> <span class="token string">&quot;<span class="token variable"><span class="token variable">$(</span><span class="token function">cat</span> ingress-patch.yaml<span class="token variable">)</span></span>&quot;</span> <span class="token parameter variable">-n</span> ingress-nginx

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><div class="hint-container info"><p class="hint-container-title">Info</p><p>You can just run simple-admin-core/deploy/k8s/setup-ingress.sh to finish the job.</p></div><blockquote><p>browse ingress IP address</p></blockquote><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code>kubectl get ingress
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><blockquote><p>You can see</p></blockquote><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code>NAME                   CLASS   HOSTS                               ADDRESS        PORTS   AGE
simple-admin-ingress   nginx   simple-admin.com,simple-admin.com   <span class="token number">192.168</span>.49.2   <span class="token number">80</span>      2m8s
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="modify-local-hosts" tabindex="-1"><a class="header-anchor" href="#modify-local-hosts"><span>Modify local hosts</span></a></h3><blockquote><p>ip is the same as ingress</p></blockquote><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code><span class="token comment"># add dns</span>
<span class="token number">192.168</span>.49.2    simple-admin.com
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="visit-the-site" tabindex="-1"><a class="header-anchor" href="#visit-the-site"><span>Visit the site</span></a></h3><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code>http://simple-admin.com:8080/
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><blockquote><p>You can see the web page.</p></blockquote>`,19);function v(h,g){const s=l("ExternalLinkIcon");return c(),o("div",null,[p,d,e("p",null,[e("a",u,[n("Minikube Install"),a(s)])]),m,e("p",null,[n("Reference "),e("a",k,[n("Official Document"),a(s)])]),b])}const x=t(r,[["render",v],["__file","minikube.html.vue"]]),q=JSON.parse('{"path":"/guide/basic-config/k8s/minikube.html","title":"Minikube Configuration","lang":"en-US","frontmatter":{"order":2,"title":"Minikube Configuration","description":"Minikube initialization Install Minikube Install Start minikube Recommend to set the memory limit in local development，my setting is 3gb minikube add plugins Enable ingress adn ...","head":[["link",{"rel":"alternate","hreflang":"zh-cn","href":"https://doc.ryansu.tech/zh/guide/basic-config/k8s/minikube.html"}],["meta",{"property":"og:url","content":"https://doc.ryansu.tech/guide/basic-config/k8s/minikube.html"}],["meta",{"property":"og:site_name","content":"Simple Admin"}],["meta",{"property":"og:title","content":"Minikube Configuration"}],["meta",{"property":"og:description","content":"Minikube initialization Install Minikube Install Start minikube Recommend to set the memory limit in local development，my setting is 3gb minikube add plugins Enable ingress adn ..."}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:locale","content":"en-US"}],["meta",{"property":"og:locale:alternate","content":"zh-CN"}],["meta",{"property":"og:updated_time","content":"2024-01-17T00:19:29.000Z"}],["meta",{"property":"article:author","content":"Ryan SU"}],["meta",{"property":"article:modified_time","content":"2024-01-17T00:19:29.000Z"}],["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"Minikube Configuration\\",\\"image\\":[\\"\\"],\\"dateModified\\":\\"2024-01-17T00:19:29.000Z\\",\\"author\\":[{\\"@type\\":\\"Person\\",\\"name\\":\\"Ryan SU\\",\\"url\\":\\"https://github.com/suyuan32\\"}]}"]]},"headers":[{"level":2,"title":"Minikube initialization","slug":"minikube-initialization","link":"#minikube-initialization","children":[{"level":3,"title":"Install","slug":"install","link":"#install","children":[]},{"level":3,"title":"Start minikube","slug":"start-minikube","link":"#start-minikube","children":[]},{"level":3,"title":"minikube add plugins","slug":"minikube-add-plugins","link":"#minikube-add-plugins","children":[]},{"level":3,"title":"Add alias","slug":"add-alias","link":"#add-alias","children":[]},{"level":3,"title":"Deploy the service","slug":"deploy-the-service","link":"#deploy-the-service","children":[]},{"level":3,"title":"Ingress Setting","slug":"ingress-setting","link":"#ingress-setting","children":[]},{"level":3,"title":"Firstly, add ingress","slug":"firstly-add-ingress","link":"#firstly-add-ingress","children":[]},{"level":3,"title":"Register tcp service into ingress configmap","slug":"register-tcp-service-into-ingress-configmap","link":"#register-tcp-service-into-ingress-configmap","children":[]},{"level":3,"title":"Register service into  ingress controller","slug":"register-service-into-ingress-controller","link":"#register-service-into-ingress-controller","children":[]},{"level":3,"title":"Modify local hosts","slug":"modify-local-hosts","link":"#modify-local-hosts","children":[]},{"level":3,"title":"Visit the site","slug":"visit-the-site","link":"#visit-the-site","children":[]}]}],"git":{"createdTime":1671464602000,"updatedTime":1705450769000,"contributors":[{"name":"Ryan SU","email":"1137661202@qq.com","commits":3},{"name":"Ryan Su","email":"yuansu.china.work@gmail.com","commits":1}]},"readingTime":{"minutes":1.17,"words":350},"filePathRelative":"guide/basic-config/k8s/minikube.md","localizedDate":"December 19, 2022","autoDesc":true,"excerpt":"<h2>Minikube initialization</h2>\\n<h3>Install</h3>\\n<p><a href=\\"https://minikube.sigs.k8s.io/docs/start/\\" target=\\"_blank\\" rel=\\"noopener noreferrer\\">Minikube Install</a></p>\\n<h3>Start minikube</h3>\\n<blockquote>\\n<p>Recommend to set the memory limit in local development，my setting is 3gb</p>\\n</blockquote>"}');export{x as comp,q as data};
