import{_ as n,a as l}from"./ent_gen_logic-DWPOcydN.js";import{_ as e}from"./plugin-vue_export-helper-DlAUqK2U.js";import{r as t,c as p,d as s,e as h,b as i,o as k}from"./app-DQF_kHgz.js";const d={},r=i('<div class="hint-container warning"><p class="hint-container-title">注意</p><p>必须了解 go zero 的 RPC 命令 <a href="https://go-zero.dev/docs/tutorials/cli/rpc" target="_blank" rel="noopener noreferrer">RPC 命令</a> <a href="https://go-zero.dev/docs/tutorials/grpc/server/configuration" target="_blank" rel="noopener noreferrer">RPC 服务</a><br> 参考 <a href="https://github.com/suyuan32/simple-admin-example-rpc" target="_blank" rel="noopener noreferrer">Example</a> 项目生成一遍，确认生成文件与 Example 项目一致，Example 项目有完整的命令</p></div>',1),c={class:"hint-container info"},g=s("p",{class:"hint-container-title"},"相关信息",-1),o=s("p",null,[s("a",{href:"https://www.bilibili.com/video/BV12s4y1R755",target:"_blank",rel:"noopener noreferrer"},"视频教程")],-1),y=i(`<h2 id="rpc-职责" tabindex="-1"><a class="header-anchor" href="#rpc-职责"><span>RPC 职责</span></a></h2><p>在 Simple Admin 中， RPC 主要用于获取数据以及提供扩展功能， 主要有以下职责：</p><ul><li>与数据库交互，获取所需数据， 如 PostgreSql</li><li>与数据源交互获取数据， 如 ES</li><li>提供额外功能供 API 层调用，如发短信，邮件</li></ul><p>多个不同的 API 都可以接入同一个 RPC 调用其功能。</p><h2 id="创建-rpc-基本项目" tabindex="-1"><a class="header-anchor" href="#创建-rpc-基本项目"><span>创建 RPC 基本项目</span></a></h2><blockquote><p>创建 example 服务</p></blockquote><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" data-title="shell" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">goctls</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> rpc</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> new</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> example</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> --ent=true</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> --module_name=github.com/suyuan32/simple-admin-example-rpc</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">  --port=8080</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> --desc=true</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><blockquote><p>简单命令</p></blockquote><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" data-title="shell" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">goctls</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> rpc</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> new</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> example</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> -e</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> -m</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> github.com/suyuan32/simple-admin-example-rpc</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">  -p</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 8080</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> -d</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><div class="hint-container warning"><p class="hint-container-title">注意</p><p>创建项目名称仅支持小写和驼峰命名, 项目名称不能包含 rpc 字符</p></div><h3 id="rpc-new参数介绍" tabindex="-1"><a class="header-anchor" href="#rpc-new参数介绍"><span><code>rpc new</code>参数介绍</span></a></h3><table><thead><tr><th>参数</th><th>必须</th><th>默认值</th><th>介绍</th><th>使用方法</th></tr></thead><tbody><tr><td>ent</td><td>否</td><td>false</td><td>是否启用 ent</td><td>true 为启用</td></tr><tr><td>module_name</td><td>否</td><td></td><td>go.mod 中的 module 名称</td><td>如果项目需要被在外部 import，需要像上面例子设置为 github 或者其他地方的仓库网址， 为空则 module 为项目名称</td></tr><tr><td>style</td><td>否</td><td>go_zero</td><td>文件名格式</td><td>go_zero 为蛇形格式</td></tr><tr><td>port</td><td>否</td><td>9100</td><td>端口号</td><td>服务暴露的端口号</td></tr><tr><td>desc</td><td>否</td><td>false</td><td>是否拆分 proto 文件到 desc 文件夹</td><td>true 会生成 desc 文件夹</td></tr><tr><td>i18n</td><td>否</td><td>false</td><td>是否启用 i18n</td><td>true 为启用</td></tr></tbody></table><p>** 详细参数请在命令行查看 <code>goctls rpc new --help</code> **</p><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" data-title="shell" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">$</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> goctls</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> rpc</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> new</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> --help</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">生成</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> rpc</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> 演示服务</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">Usage:</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  goctl</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> rpc</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> new</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> [flags]</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">Flags:</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">      --branch</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> string</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">            远程</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> repo</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> 的分支，与</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> --remote</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> 一起使用</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  -d,</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> --desc</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">                     是否为拆分</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> proto</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> 文件创建</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> desc</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> 文件夹</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  -e,</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> --ent</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">                      是否在项目中使用</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> Ent</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  -h,</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> --help</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">                     help</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> for</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> new</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">      --home</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> string</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">              模板的</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> goctl</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> 路径，--home</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> 和</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> --remote</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> 不能同时设置，如果设置了，--remote</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> 优先级更高</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  -i,</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> --i18n</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">                     是否启用</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> i18n</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> 国际化</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">      --idea</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">                     对于</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> idea</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> 插件</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> [可选]</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  -m,</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> --module_name</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> string</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">       go.mod</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> 中的模块名称，例如：github.com/suyuan32/simple-admin-core</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  -p,</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> --port</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> int</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">                 服务公开的端口</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (default </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">9110</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">      --remote</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> string</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">            模板的远程</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> git</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> repo，--home</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> 和</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> --remote</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> 不能同时设置，如果设置了，--remote</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> 优先级更高</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">                                 Git</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> repo</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> 的目录结构必须与</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> https://github.com/zeromicro/go-zero-template</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> 相一致</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  -s,</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> --style</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> string</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">             文件命名格式，参见</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> [https://github.com/zeromicro/go-zero/blob/master/tools/goctl/config/readme.md] (</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">default</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &quot;go_zero&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  -v,</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> --verbose</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">                  启用日志输出</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><blockquote><p>你可以看到如下项目结构</p></blockquote><figure><img src="`+n+`" alt="Example" tabindex="0" loading="lazy"><figcaption>Example</figcaption></figure><h3 id="文件结构" tabindex="-1"><a class="header-anchor" href="#文件结构"><span>文件结构</span></a></h3><div class="language-text line-numbers-mode" data-highlighter="shiki" data-ext="text" data-title="text" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>├── desc                                  proto 文件目录</span></span>
<span class="line"><span>├── ent                                   ent 文件目录</span></span>
<span class="line"><span>│   ├── enttest</span></span>
<span class="line"><span>│   ├── hook</span></span>
<span class="line"><span>│   ├── migrate</span></span>
<span class="line"><span>│   ├── predicate</span></span>
<span class="line"><span>│   ├── runtime</span></span>
<span class="line"><span>│   ├── schema                            ent schema声明目录</span></span>
<span class="line"><span>│   ├── student</span></span>
<span class="line"><span>│   ├── teacher</span></span>
<span class="line"><span>│   └── template</span></span>
<span class="line"><span>├── etc                                   配置文件目录</span></span>
<span class="line"><span>├── example                               grpc和types目录</span></span>
<span class="line"><span>├── exampleclient                         客户端client目录</span></span>
<span class="line"><span>└── internal</span></span>
<span class="line"><span>    ├── config</span></span>
<span class="line"><span>    ├── logic                             业务代码目录</span></span>
<span class="line"><span>    │   ├── base</span></span>
<span class="line"><span>    │   ├── student</span></span>
<span class="line"><span>    │   └── teacher</span></span>
<span class="line"><span>    ├── server</span></span>
<span class="line"><span>    └── svc                               全局service_context目录</span></span>
<span class="line"><span>    └── utils                             工具库如 ent 错误处理以及事务函数</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>然后编辑 etc/example.yaml</p><div class="language-yaml line-numbers-mode" data-highlighter="shiki" data-ext="yaml" data-title="yaml" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">Name</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">example.rpc</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">ListenOn</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">0.0.0.0:8080</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">DatabaseConf</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">  Type</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">mysql</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">  Host</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">127.0.0.1</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">  Port</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">3306</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">  DBName</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">simple_admin</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">  Username</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">root</span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;"> # set your username</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">  Password</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;123456&quot;</span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;"> # set your password</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">  MaxOpenConn</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">100</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">  SSLMode</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">disable</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">  CacheTime</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">5</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">RedisConf</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">  Host</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">127.0.0.1:6379</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">  Type</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">node</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">Log</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">  ServiceName</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">exampleRpcLogger</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">  Mode</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">file</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">  Path</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">/home/ryan/data/logs/example/rpc</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">  Encoding</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">json</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">  Level</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">info</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">  Compress</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">false</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">  KeepDays</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">7</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">  StackCoolDownMillis</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">100</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">Prometheus</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">  Host</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">0.0.0.0</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">  Port</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">4001</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">  Path</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">/metrics</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="编辑-schema" tabindex="-1"><a class="header-anchor" href="#编辑-schema"><span>编辑 schema</span></a></h3><p>进入目录 ent/schema, 修改 example.go, 改名为 student.go 添加 mixin 和字段 address 和 uuid</p><div class="language-go line-numbers-mode" data-highlighter="shiki" data-ext="go" data-title="go" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">package</span><span style="--shiki-light:#6F42C1;--shiki-dark:#E5C07B;"> schema</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#98C379;">entgo.io/ent</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#98C379;">entgo.io/ent/schema/field</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#98C379;">github.com/suyuan32/simple-admin-common/orm/ent/mixins</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// Student holds the schema definition for the Student entity.</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">type</span><span style="--shiki-light:#6F42C1;--shiki-dark:#E5C07B;"> Student</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> struct</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#E5C07B;"> ent</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#E5C07B;">Schema</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// Fields of the Student.</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">func</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#6F42C1;--shiki-dark:#E5C07B;">Student</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">Fields</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">() []</span><span style="--shiki-light:#6F42C1;--shiki-dark:#E5C07B;">ent</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#E5C07B;">Field</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> return</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> []</span><span style="--shiki-light:#6F42C1;--shiki-dark:#E5C07B;">ent</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#E5C07B;">Field</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">{</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">  field</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">String</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;name&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">),</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">  field</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">Int</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;age&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">),</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">func</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#6F42C1;--shiki-dark:#E5C07B;">Student</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">Mixin</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">() []</span><span style="--shiki-light:#6F42C1;--shiki-dark:#E5C07B;">ent</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#E5C07B;">Mixin</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> return</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> []</span><span style="--shiki-light:#6F42C1;--shiki-dark:#E5C07B;">ent</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#E5C07B;">Mixin</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">{</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#E5C07B;">  mixins</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#E5C07B;">IDMixin</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">{},</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// Edges of the Student.</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">func</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#6F42C1;--shiki-dark:#E5C07B;">Student</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">Edges</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">() []</span><span style="--shiki-light:#6F42C1;--shiki-dark:#E5C07B;">ent</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#E5C07B;">Edge</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> return</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> nil</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="生成-ent-代码" tabindex="-1"><a class="header-anchor" href="#生成-ent-代码"><span>生成 Ent 代码</span></a></h3><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" data-title="shell" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">make</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> gen-ent</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h3 id="生成-student-逻辑代码" tabindex="-1"><a class="header-anchor" href="#生成-student-逻辑代码"><span>生成 Student 逻辑代码</span></a></h3><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" data-title="shell" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">goctls</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> rpc</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ent</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> --schema=./ent/schema</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">  --style=go_zero</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> --multiple=false</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> --service_name=Example</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> --output=./</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> --model=Student</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> --group=student</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> --proto_out=./desc/student.proto</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">make</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> gen-rpc</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="rpc-ent参数介绍" tabindex="-1"><a class="header-anchor" href="#rpc-ent参数介绍"><span><code>rpc ent</code>参数介绍</span></a></h3><table><thead><tr><th>参数</th><th>必须</th><th>默认值</th><th>介绍</th><th>使用方法</th></tr></thead><tbody><tr><td>schema</td><td>是</td><td></td><td>schema 文件地址</td><td>输入 Ent schema 文件夹相对路径</td></tr><tr><td>style</td><td>否</td><td>go_zero</td><td>文件名格式</td><td>go_zero 为蛇形格式</td></tr><tr><td>i18n</td><td>否</td><td>false</td><td>是否启用 i18n</td><td>true 为启用</td></tr><tr><td>service_name</td><td>是</td><td></td><td>服务名称</td><td>和 proto 文件中的 service 名称相同</td></tr><tr><td>project_name</td><td>是</td><td></td><td>项目名称</td><td>和 new 时的名称相同，和 main 文件名一致, 在 multiple 模式下需要设置，单 service 默认和 service name 相同</td></tr><tr><td>output</td><td>是</td><td></td><td>输出位置</td><td>文件输出位置，可以为相对路径，指向 main 文件目录</td></tr><tr><td>model</td><td>是</td><td></td><td>模型名称</td><td>生成的模型名称，例如：User，如果为 &quot;all&quot;，则为 schema 目录中所有模型生成代码</td></tr><tr><td>search_key_num</td><td>否</td><td>3</td><td>搜索字段数量（默认为 3）</td><td>列表搜索字段数量，只能自动生成 string 的字段</td></tr><tr><td>group</td><td>是</td><td></td><td>分组名称</td><td>分组名称用于将不同 logic 文件放到不同文件夹</td></tr><tr><td>multiple</td><td>否</td><td>false</td><td>多服务</td><td>若 proto 文件中有多个 service, 需要设置为 true</td></tr><tr><td>proto_out</td><td>否</td><td></td><td>是否拆分 proto 文件</td><td>若为空则会将数据生成到项目根目录的 proto 文件，否则将会生成到指定路径 desc 中，如 ./desc/student.proto, 注意存放 proto 的文件夹必须为 desc, 内部可以有子文件夹</td></tr><tr><td>proto_field_style</td><td>否</td><td>go_zero</td><td>proto 字段命名格式</td><td>默认为下划线</td></tr><tr><td>import_prefix</td><td>否</td><td></td><td>导入路径前缀</td><td>导入路径的前缀，仅用于项目位于子目录的情况，如 core 的 rpc 和 api</td></tr><tr><td>overwrite</td><td>否</td><td>false</td><td>是否覆盖生成文件</td><td>true 则会覆盖所有生成的文件</td></tr></tbody></table><div class="hint-container info"><p class="hint-container-title">相关信息</p><p>multiple 例子, multiple 用于根据不同服务生成多个 rpcclient</p><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" data-title="shell" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">goctls</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> api</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> proto</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> --proto=/home/ryan/GolandProjects/simple-admin-example-rpc/example.proto</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> --style=go_zero</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> --api_service_name=example</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> --rpc_service_name=school</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> --output=./</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> --model=Teacher</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> --rpc_name=School</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> --grpc_package=github.com/suyuan32/simple-admin-example-rpc/example</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> --multiple=true</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p><a href="https://github.com/suyuan32/simple-admin-example-rpc/tree/multiple-example" target="_blank" rel="noopener noreferrer">示例代码</a></p></div><p>详细参数请在命令行查看 <code>goctls rpc ent --help</code></p><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" data-title="shell" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">$</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> goctls</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> rpc</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ent</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> --help</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">通过</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> Ent</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> 生成</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> CRUD</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> 模板代码</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">Usage:</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  goctls</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> rpc</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ent</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> [flags]</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">Flags:</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  -g,</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> --group</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> string</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">               逻辑的组名称，例如：user</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  -h,</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> --help</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">                       help</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> for</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ent</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  -i,</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> --i18n</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">                       是否启用</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> i18n</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> 国际化</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  -x,</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> --import_prefix</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> string</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">       导入路径的前缀，仅用于项目位于子目录的情况，如</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> core</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> 的</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> rpc</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> 和</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> api</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  -m,</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> --model</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> string</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">               生成的模型名称，例如：User，如果为</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &quot;all&quot;，则为</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> schema</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> 目录中所有模型生成代码</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">      --multiple</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">                   在多个</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> rpc</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> 服务模式下生成</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  -o,</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> --output</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> string</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">              输出路径</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  -w,</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> --overwrite</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">                  是否覆盖文件，它将覆盖所有生成的文件</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  -p,</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> --project_name</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> string</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">        项目名称</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  -f,</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> --proto_field_style</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> string</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">   proto</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> 字段样式</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (default </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;go_zero&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  -t,</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> --proto_out</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> string</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">           输出</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> proto</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> 文件路径</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  -c,</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> --schema</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> string</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">              Ent</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> 的</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> schema</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> 路径</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  -k,</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> --search_key_num</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> int</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">         搜索键的最大数量</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (default </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">3</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  -r,</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> --service_name</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> string</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">        服务名称</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  -s,</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> --style</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> string</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">               文件名格式样式</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (default </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;go_zero&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">)</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="hint-container warning"><p class="hint-container-title">注意</p><p>注意： 工具会自动识别 desc 文件夹中的 proto 文件，desc 内部也可以创建子文件夹，package 和 go_package 只需在 base.proto 声明一次， 工具会自动将所有 proto 文件合并至项目根目录的 proto 文件中。旧项目拆分 proto 文件只需将根目录下的 proto 自行拆分至 desc 文件夹即可。</p></div><div class="hint-container info"><p class="hint-container-title">相关信息</p><p>快捷命令 <code>make gen-rpc-ent-logic model={modelName} group={groupName}</code> 表示生成 schema 为 <code>{modelName}</code> 的代码，<code>{groupName}</code>为分组名称，注意 modelName 需要首字母大写，和 schema 中的 struct 名称保持一致。使用 <code>make gen-rpc-ent-logic model=all group=all</code> 生成所有 schema 的 CRUD 代码。</p></div><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" data-title="shell" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;"># 生成 schema 中的 Student 结构</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">make</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> gen-rpc-ent-logic</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> model=Student</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> group=student</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">make</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> gen-rpc</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;"># 可能需要运行下</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">go</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> mod</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> tidy</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="`+l+`" alt="logic" tabindex="0" loading="lazy"><figcaption>logic</figcaption></figure><p>可以看到 crud 代码已生成</p><blockquote><p>proto 文件代码</p></blockquote><div class="language-plain line-numbers-mode" data-highlighter="shiki" data-ext="plain" data-title="plain" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>syntax = &quot;proto3&quot;;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>package example;</span></span>
<span class="line"><span>option go_package=&quot;./example&quot;;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>message Empty {}</span></span>
<span class="line"><span></span></span>
<span class="line"><span>message IDReq {</span></span>
<span class="line"><span>  uint64 id = 1;</span></span>
<span class="line"><span>}</span></span>
<span class="line"><span></span></span>
<span class="line"><span>message IDsReq {</span></span>
<span class="line"><span>  repeated uint64 ids = 1;</span></span>
<span class="line"><span>}</span></span>
<span class="line"><span></span></span>
<span class="line"><span>message UUIDReq {</span></span>
<span class="line"><span>  string uuid = 1;</span></span>
<span class="line"><span>}</span></span>
<span class="line"><span></span></span>
<span class="line"><span>message BaseResp {</span></span>
<span class="line"><span>  string msg = 1;</span></span>
<span class="line"><span>}</span></span>
<span class="line"><span></span></span>
<span class="line"><span>message PageInfoReq {</span></span>
<span class="line"><span>  uint64 page = 1;</span></span>
<span class="line"><span>  uint64 page_size = 2;</span></span>
<span class="line"><span>}</span></span>
<span class="line"><span></span></span>
<span class="line"><span></span></span>
<span class="line"><span>// Student message</span></span>
<span class="line"><span></span></span>
<span class="line"><span>message StudentInfo {</span></span>
<span class="line"><span>  uint64 id = 1;</span></span>
<span class="line"><span>  int64 created_at = 2;</span></span>
<span class="line"><span>  int64 updated_at = 3;</span></span>
<span class="line"><span>  string name = 4;</span></span>
<span class="line"><span>  int64 age = 5;</span></span>
<span class="line"><span>}</span></span>
<span class="line"><span></span></span>
<span class="line"><span>message StudentListResp {</span></span>
<span class="line"><span>  uint64 total = 1;</span></span>
<span class="line"><span>  repeated StudentInfo data = 2;</span></span>
<span class="line"><span>}</span></span>
<span class="line"><span></span></span>
<span class="line"><span>message StudentPageReq {</span></span>
<span class="line"><span>  uint64 page = 1;</span></span>
<span class="line"><span>  uint64 page_size = 2;</span></span>
<span class="line"><span>  string name = 3;</span></span>
<span class="line"><span>}</span></span>
<span class="line"><span></span></span>
<span class="line"><span>service Example {</span></span>
<span class="line"><span>  // group: base</span></span>
<span class="line"><span>  rpc initDatabase (Empty) returns (BaseResp);</span></span>
<span class="line"><span></span></span>
<span class="line"><span>  // Student management</span></span>
<span class="line"><span>  // group: student</span></span>
<span class="line"><span>  rpc createOrUpdateStudent (StudentInfo) returns (BaseResp);</span></span>
<span class="line"><span>  // group: student</span></span>
<span class="line"><span>  rpc getStudentList (StudentPageReq) returns (StudentListResp);</span></span>
<span class="line"><span>  // group: student</span></span>
<span class="line"><span>  rpc deleteStudent (IDReq) returns (BaseResp);</span></span>
<span class="line"><span>  // group: student</span></span>
<span class="line"><span>  rpc batchDeleteStudent (IDsReq) returns (BaseResp);</span></span>
<span class="line"><span>}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>使用 group 注释给 rpc 分组</p><blockquote><p>然后代码就可以运行啦 !</p></blockquote><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" data-title="shell" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">go</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> run</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> example.go</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> -f</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> etc/example.yaml</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><blockquote><p>如果看到</p></blockquote><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" data-title="shell" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">Starting</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> server</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> at</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> 127.0.0.1:8080...</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>说明运行成功.</p><div class="hint-container warning"><p class="hint-container-title">注意</p><p>后续还需要修改数据库初始化函数，参考 <a href="https://github.com/suyuan32/simple-admin-member-rpc/blob/main/internal/logic/base/init_database_logic.go" target="_blank" rel="noopener noreferrer">simple admin member</a></p></div><blockquote><p>项目地址 <a href="https://github.com/suyuan32/simple-admin-example-rpc" target="_blank" rel="noopener noreferrer">https://github.com/suyuan32/simple-admin-example-rpc</a></p></blockquote><h2 id="simple-admin-example-api-中如何远程调用该-rpc" tabindex="-1"><a class="header-anchor" href="#simple-admin-example-api-中如何远程调用该-rpc"><span>simple admin example api 中如何远程调用该 RPC</span></a></h2><h3 id="添加-config" tabindex="-1"><a class="header-anchor" href="#添加-config"><span>添加 config</span></a></h3><div class="language-go line-numbers-mode" data-highlighter="shiki" data-ext="go" data-title="go" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">package</span><span style="--shiki-light:#6F42C1;--shiki-dark:#E5C07B;"> config</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#98C379;">github.com/suyuan32/simple-admin-core/rpc/config</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#98C379;">github.com/zeromicro/go-zero/core/stores/redis</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#98C379;">github.com/zeromicro/go-zero/rest</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#98C379;">github.com/zeromicro/go-zero/zrpc</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">type</span><span style="--shiki-light:#6F42C1;--shiki-dark:#E5C07B;"> Config</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> struct</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#E5C07B;"> rest</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#E5C07B;">RestConf</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> Auth</span><span style="--shiki-light:#6F42C1;--shiki-dark:#E5C07B;">         rest</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#E5C07B;">AuthConf</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> DatabaseConf</span><span style="--shiki-light:#6F42C1;--shiki-dark:#E5C07B;"> config</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#E5C07B;">DatabaseConf</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> RedisConf</span><span style="--shiki-light:#6F42C1;--shiki-dark:#E5C07B;">    redis</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#E5C07B;">RedisConf</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> CasbinConf</span><span style="--shiki-light:#6F42C1;--shiki-dark:#E5C07B;">   config</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#E5C07B;">CasbinConf</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> ExampleRpc</span><span style="--shiki-light:#6F42C1;--shiki-dark:#E5C07B;">   zrpc</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#E5C07B;">RpcClientConf</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="添加-example-rpc" tabindex="-1"><a class="header-anchor" href="#添加-example-rpc"><span>添加 example rpc</span></a></h3><blockquote><p>修改 service context</p></blockquote><div class="language-go line-numbers-mode" data-highlighter="shiki" data-ext="go" data-title="go" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">package</span><span style="--shiki-light:#6F42C1;--shiki-dark:#E5C07B;"> svc</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#98C379;">github.com/suyuan32/simple-admin-example-rpc/exampleclient</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#98C379;">github.com/zeromicro/go-zero/zrpc</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#98C379;">github.com/suyuan32/simple-admin-example-api/internal/config</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> i18n2</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#98C379;">github.com/suyuan32/simple-admin-example-api/internal/i18n</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#98C379;">github.com/suyuan32/simple-admin-example-api/internal/middleware</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#98C379;">github.com/suyuan32/simple-admin-core/api/internal/i18n</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#98C379;">github.com/casbin/casbin/v2</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#98C379;">github.com/zeromicro/go-zero/core/logx</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#98C379;">github.com/zeromicro/go-zero/rest</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">type</span><span style="--shiki-light:#6F42C1;--shiki-dark:#E5C07B;"> ServiceContext</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> struct</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> Config</span><span style="--shiki-light:#6F42C1;--shiki-dark:#E5C07B;">     config</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#E5C07B;">Config</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> ExampleRpc</span><span style="--shiki-light:#6F42C1;--shiki-dark:#E5C07B;"> exampleclient</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#E5C07B;">Example</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> Casbin</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">     *</span><span style="--shiki-light:#6F42C1;--shiki-dark:#E5C07B;">casbin</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#E5C07B;">Enforcer</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> Authority</span><span style="--shiki-light:#6F42C1;--shiki-dark:#E5C07B;">  rest</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#E5C07B;">Middleware</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> Trans</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">      *</span><span style="--shiki-light:#6F42C1;--shiki-dark:#E5C07B;">i18n</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#E5C07B;">Translator</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">func</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> NewServiceContext</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">c</span><span style="--shiki-light:#6F42C1;--shiki-dark:#E5C07B;"> config</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#E5C07B;">Config</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">*</span><span style="--shiki-light:#6F42C1;--shiki-dark:#E5C07B;">ServiceContext</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> rds</span><span style="--shiki-light:#D73A49;--shiki-dark:#E5C07B;"> :=</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> redis</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">MustNewRedis</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">c</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">RedisConf</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> cbn</span><span style="--shiki-light:#D73A49;--shiki-dark:#E5C07B;"> :=</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> c</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">CasbinConf</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">MustNewCasbinWithRedisWatcher</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">c</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">DatabaseConf</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">Type</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">c</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">DatabaseConf</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">GetDSN</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(), </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">c</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">RedisConf</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> trans</span><span style="--shiki-light:#D73A49;--shiki-dark:#E5C07B;"> :=</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> i18n</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">NewTranslator</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">i18n2</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">LocaleFS</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> return</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> &amp;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#E5C07B;">ServiceContext</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">{</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">  Config</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">:     </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">c</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">  Authority</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">:  </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">middleware</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">NewAuthorityMiddleware</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">cbn</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">rds</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">).</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">Handle</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">  Trans</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">:      </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">trans</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">  ExampleRpc</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">exampleclient</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">NewExample</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">zrpc</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">NewClientIfEnable</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">c</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">ExampleRpc</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">)),</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>然后在 logic 直接调用 l.svcCtx.ExampleRpc 即可</p><blockquote><p>simple admin example api 地址 <a href="https://github.com/suyuan32/simple-admin-example-api" target="_blank" rel="noopener noreferrer">https://github.com/suyuan32/simple-admin-example-api</a></p></blockquote>`,55);function m(u,C){const a=t("BiliBili");return k(),p("div",null,[r,s("div",c,[g,o,h(a,{bvid:"BV12s4y1R755"})]),y])}const B=e(d,[["render",m],["__file","rpc_example.html.vue"]]),E=JSON.parse('{"path":"/zh/guide/quick-start/codegen/rpc_example.html","title":"RPC 微服务","lang":"zh-CN","frontmatter":{"order":2,"title":"RPC 微服务","head":[["meta",{"name":"keywords","content":"goctls, rpc, rpc code generation, micro services, 微服务, 代码生成"}],["link",{"rel":"alternate","hreflang":"en-us","href":"https://doc.ryansu.tech/guide/quick-start/codegen/rpc_example.html"}],["meta",{"property":"og:url","content":"https://doc.ryansu.tech/zh/guide/quick-start/codegen/rpc_example.html"}],["meta",{"property":"og:site_name","content":"Simple Admin"}],["meta",{"property":"og:title","content":"RPC 微服务"}],["meta",{"property":"og:description","content":"注意 必须了解 go zero 的 RPC 命令 RPC 命令 RPC 服务 参考 Example 项目生成一遍，确认生成文件与 Example 项目一致，Example 项目有完整的命令 相关信息 视频教程 RPC 职责 在 Simple Admin 中， RPC 主要用于获取数据以及提供扩展功能， 主要有以下职责： 与数据库交互，获取所需数据， 如..."}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:image","content":"https://doc.ryansu.tech/assets/example_rpc_struct.png"}],["meta",{"property":"og:locale","content":"zh-CN"}],["meta",{"property":"og:locale:alternate","content":"en-US"}],["meta",{"property":"og:updated_time","content":"2024-05-28T10:47:03.000Z"}],["meta",{"property":"article:author","content":"Ryan SU"}],["meta",{"property":"article:modified_time","content":"2024-05-28T10:47:03.000Z"}],["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"RPC 微服务\\",\\"image\\":[\\"https://doc.ryansu.tech/assets/example_rpc_struct.png\\",\\"https://doc.ryansu.tech/assets/ent_gen_logic.png\\"],\\"dateModified\\":\\"2024-05-28T10:47:03.000Z\\",\\"author\\":[{\\"@type\\":\\"Person\\",\\"name\\":\\"Ryan SU\\",\\"url\\":\\"https://github.com/suyuan32\\"}]}"]],"description":"注意 必须了解 go zero 的 RPC 命令 RPC 命令 RPC 服务 参考 Example 项目生成一遍，确认生成文件与 Example 项目一致，Example 项目有完整的命令 相关信息 视频教程 RPC 职责 在 Simple Admin 中， RPC 主要用于获取数据以及提供扩展功能， 主要有以下职责： 与数据库交互，获取所需数据， 如..."},"headers":[{"level":2,"title":"RPC 职责","slug":"rpc-职责","link":"#rpc-职责","children":[]},{"level":2,"title":"创建 RPC 基本项目","slug":"创建-rpc-基本项目","link":"#创建-rpc-基本项目","children":[{"level":3,"title":"rpc new参数介绍","slug":"rpc-new参数介绍","link":"#rpc-new参数介绍","children":[]},{"level":3,"title":"文件结构","slug":"文件结构","link":"#文件结构","children":[]},{"level":3,"title":"编辑 schema","slug":"编辑-schema","link":"#编辑-schema","children":[]},{"level":3,"title":"生成 Ent 代码","slug":"生成-ent-代码","link":"#生成-ent-代码","children":[]},{"level":3,"title":"生成 Student 逻辑代码","slug":"生成-student-逻辑代码","link":"#生成-student-逻辑代码","children":[]},{"level":3,"title":"rpc ent参数介绍","slug":"rpc-ent参数介绍","link":"#rpc-ent参数介绍","children":[]}]},{"level":2,"title":"simple admin example api 中如何远程调用该 RPC","slug":"simple-admin-example-api-中如何远程调用该-rpc","link":"#simple-admin-example-api-中如何远程调用该-rpc","children":[{"level":3,"title":"添加 config","slug":"添加-config","link":"#添加-config","children":[]},{"level":3,"title":"添加 example rpc","slug":"添加-example-rpc","link":"#添加-example-rpc","children":[]}]}],"git":{"createdTime":1671464359000,"updatedTime":1716893223000,"contributors":[{"name":"Ryan SU","email":"yuansu.china.work@gmail.com","commits":19},{"name":"Ryan SU","email":"1137661202@qq.com","commits":16},{"name":"Ryan Su","email":"yuansu.china.work@gmail.com","commits":5},{"name":"Larmian","email":"65385917+Larmian@users.noreply.github.com","commits":1}]},"readingTime":{"minutes":7.18,"words":2155},"filePathRelative":"zh/guide/quick-start/codegen/rpc_example.md","localizedDate":"2022年12月19日","autoDesc":true,"excerpt":"<div class=\\"hint-container warning\\">\\n<p class=\\"hint-container-title\\">注意</p>\\n<p>必须了解 go zero 的 RPC 命令 <a href=\\"https://go-zero.dev/docs/tutorials/cli/rpc\\" target=\\"_blank\\" rel=\\"noopener noreferrer\\">RPC 命令</a> <a href=\\"https://go-zero.dev/docs/tutorials/grpc/server/configuration\\" target=\\"_blank\\" rel=\\"noopener noreferrer\\">RPC 服务</a>\\n<br>\\n参考 <a href=\\"https://github.com/suyuan32/simple-admin-example-rpc\\" target=\\"_blank\\" rel=\\"noopener noreferrer\\">Example</a> 项目生成一遍，确认生成文件与 Example 项目一致，Example 项目有完整的命令</p>\\n</div>"}');export{B as comp,E as data};
